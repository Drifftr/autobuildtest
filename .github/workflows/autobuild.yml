name: Auto Build Action Test
"on":
  workflow_dispatch:
    inputs:
      configurables:
        description: configurables list json
        required: false
jobs:
  build:
    runs-on: ubuntu-latest
    env:
      TEMPLATE: service
      ORG_NAME: heshithahettihewa
      MODULE_NAME: autobuildtest
    container:
      image: ballerina/ballerina:2201.1.1
      options: --user root
    steps:
      - name: Checkout Source Code
        uses: actions/checkout@v2
      - name: Choreo Toml Parser
        uses: choreo-templates/ballerina-toml-parser@v2
        with:
          type: read
      - name: Ballerina Build
        run: |
          bal build --sticky --export-openapi --generate-config-schema
      - run: pwd
      - name: Prepare Python Script
        run: echo 'ewogICAgImpzb25TY2hlbWEiOiAiZXdvZ0lDSWtjMk5vWlcxaElqb2dJbWgwZEhBNkx5OXFjMjl1TFhOamFHVnRZUzV2Y21jdlpISmhablF0XG5NRGN2YzJOb1pXMWhJeUlzQ2lBZ0luUjVjR1VpT2lBaWIySnFaV04wSWl3S0lDQWljSEp2Y0dWeWRHbGxcbmN5STZJSHNLSUNBZ0lDSm9aWE5vYVhSb1lXaGxkSFJwYUdWM1lTSTZJSHNLSUNBZ0lDQWdJblI1Y0dVaVxuT2lBaWIySnFaV04wSWl3S0lDQWdJQ0FnSW5CeWIzQmxjblJwWlhNaU9pQjdDaUFnSUNBZ0lDQWdJbVJsXG5abUYxYkhSZmQyVmlhRzl2YTE5M2R5STZJSHNLSUNBZ0lDQWdJQ0FnSUNKMGVYQmxJam9nSW05aWFtVmpcbmRDSXNDaUFnSUNBZ0lDQWdJQ0FpY0hKdmNHVnlkR2xsY3lJNklIc0tJQ0FnSUNBZ0lDQWdJQ0FnSW1OdlxuYm1acFp5STZJSHNLSUNBZ0lDQWdJQ0FnSUNBZ0lDQWlkSGx3WlNJNklDSnZZbXBsWTNRaUxBb2dJQ0FnXG5JQ0FnSUNBZ0lDQWdJQ0p3Y205d1pYSjBhV1Z6SWpvZ2V3b2dJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0luVnpcblpYSnVZVzFsSWpvZ2V3b2dJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0lDQWlkSGx3WlNJNklDSnpkSEpwYm1jaVxuQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0I5TEFvZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSW5CaGMzTjNiM0prXG5Jam9nZXdvZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBaWRIbHdaU0k2SUNKemRISnBibWNpQ2lBZ0lDQWdcbklDQWdJQ0FnSUNBZ0lDQjlMQW9nSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJbU5vWVc1dVpXeE9ZVzFsSWpvZ1xuZXdvZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNBaWRIbHdaU0k2SUNKemRISnBibWNpQ2lBZ0lDQWdJQ0FnXG5JQ0FnSUNBZ0lDQjlMQW9nSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJbkpsY0d4aGVVWnliMjBpT2lCN0NpQWdcbklDQWdJQ0FnSUNBZ0lDQWdJQ0FnSUNKMGVYQmxJam9nSW1sdWRHVm5aWElpQ2lBZ0lDQWdJQ0FnSUNBZ1xuSUNBZ0lDQjlMQW9nSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJbVZ1ZG1seWIyNXRaVzUwSWpvZ2V3b2dJQ0FnXG5JQ0FnSUNBZ0lDQWdJQ0FnSUNBaWRIbHdaU0k2SUNKemRISnBibWNpQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdcbklDQjlDaUFnSUNBZ0lDQWdJQ0FnSUNBZ2ZTd0tJQ0FnSUNBZ0lDQWdJQ0FnSUNBaVlXUmthWFJwYjI1aFxuYkZCeWIzQmxjblJwWlhNaU9pQm1ZV3h6WlN3S0lDQWdJQ0FnSUNBZ0lDQWdJQ0FpY21WeGRXbHlaV1FpXG5PaUJiQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FpZFhObGNtNWhiV1VpTEFvZ0lDQWdJQ0FnSUNBZ0lDQWdcbklDQWdJbkJoYzNOM2IzSmtJaXdLSUNBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0pqYUdGdWJtVnNUbUZ0WlNJc1xuQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FpY21Wd2JHRjVSbkp2YlNJc0NpQWdJQ0FnSUNBZ0lDQWdJQ0FnXG5JQ0FpWlc1MmFYSnZibTFsYm5RaUNpQWdJQ0FnSUNBZ0lDQWdJQ0FnWFN3S0lDQWdJQ0FnSUNBZ0lDQWdcbklDQWlibUZ0WlNJNklDSmlZV3hzWlhKcGJtRjRMM1J5YVdkblpYSXVjMkZzWlhObWIzSmpaVG93TGpRdVxuTURwTWFYTjBaVzVsY2tOdmJtWnBaeUlzQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJbVJsYzJOeWFYQjBhVzl1XG5Jam9nSWlJS0lDQWdJQ0FnSUNBZ0lDQWdmUW9nSUNBZ0lDQWdJQ0FnZlN3S0lDQWdJQ0FnSUNBZ0lDSmhcblpHUnBkR2x2Ym1Gc1VISnZjR1Z5ZEdsbGN5STZJR1poYkhObExBb2dJQ0FnSUNBZ0lDQWdJbkpsY1hWcFxuY21Wa0lqb2dXd29nSUNBZ0lDQWdJQ0FnSUNBaVkyOXVabWxuSWdvZ0lDQWdJQ0FnSUNBZ1hRb2dJQ0FnXG5JQ0FnSUgwS0lDQWdJQ0FnZlN3S0lDQWdJQ0FnSW1Ga1pHbDBhVzl1WVd4UWNtOXdaWEowYVdWeklqb2dcblptRnNjMlVLSUNBZ0lIMEtJQ0I5TEFvZ0lDSmhaR1JwZEdsdmJtRnNVSEp2Y0dWeWRHbGxjeUk2SUdaaFxuYkhObENuMEtcbiIsCiAgICAiY29uZmlndXJhdGlvbk1vdW50IjogWwogICAgICAgIHsKICAgICAgICAgICAgImNvbmZpZ0tleU5hbWUiOiAiY29uZmlnLnVzZXJuYW1lIiwKICAgICAgICAgICAgInZhbHVlVHlwZSI6ICJzdHJpbmciLAogICAgICAgICAgICAicGFyZW50T2JqZWN0VHlwZSI6ICJiYWxsZXJpbmF4L3RyaWdnZXIuc2FsZXNmb3JjZTowLjQuMDpMaXN0ZW5lckNvbmZpZyIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgImNvbmZpZ0tleU5hbWUiOiAiY29uZmlnLnBhc3N3b3JkIiwKICAgICAgICAgICAgInZhbHVlVHlwZSI6ICJzdHJpbmciLAogICAgICAgICAgICAicGFyZW50T2JqZWN0VHlwZSI6ICJiYWxsZXJpbmF4L3RyaWdnZXIuc2FsZXNmb3JjZTowLjQuMDpMaXN0ZW5lckNvbmZpZyIKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgImNvbmZpZ0tleU5hbWUiOiAiY29uZmlnLmNoYW5uZWxOYW1lIiwKICAgICAgICAgICAgInZhbHVlVHlwZSI6ICJzdHJpbmciLAogICAgICAgICAgICAiaXNSZXF1aXJlZCI6IHRydWUsCiAgICAgICAgICAgICJwYXJlbnRPYmplY3RUeXBlIjogImJhbGxlcmluYXgvdHJpZ2dlci5zYWxlc2ZvcmNlOjAuNC4wOkxpc3RlbmVyQ29uZmlnIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICAiY29uZmlnS2V5TmFtZSI6ICJjb25maWcucmVwbGF5RnJvbSIsCiAgICAgICAgICAgICJ2YWx1ZVR5cGUiOiAiaW50ZWdlciIsCiAgICAgICAgICAgICJwYXJlbnRPYmplY3RUeXBlIjogImJhbGxlcmluYXgvdHJpZ2dlci5zYWxlc2ZvcmNlOjAuNC4wOkxpc3RlbmVyQ29uZmlnIgogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICAiY29uZmlnS2V5TmFtZSI6ICJjb25maWcuZW52aXJvbm1lbnQiLAogICAgICAgICAgICAidmFsdWVUeXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICJpc1JlcXVpcmVkIjogdHJ1ZSwKICAgICAgICAgICAgInBhcmVudE9iamVjdFR5cGUiOiAiYmFsbGVyaW5heC90cmlnZ2VyLnNhbGVzZm9yY2U6MC40LjA6TGlzdGVuZXJDb25maWciCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgICJjb25maWdLZXlOYW1lIjogImNvbmZpZzIiLAogICAgICAgICAgICAidmFsdWVUeXBlIjogInN0cmluZyIsCiAgICAgICAgICAgICJpc1JlcXVpcmVkIjogdHJ1ZSwKICAgICAgICAgICAgInBhcmVudE9iamVjdFR5cGUiOiAiYmFsbGVyaW5heC90cmlnZ2VyLnNhbGVzZm9yY2U6MC40LjA6TGlzdGVuZXJDb25maWciCiAgICAgICAgfQogICAgICAgIAogICAgXQp9' | base64 -d > input.json
      - name: Install dependencies
        run: |
          python3 -m pip install --upgrade pip
          pip install requests
      - name: Run Python Script
        if: ${{ github.event.inputs.configurables != '' }}
        env:
          CONFIG_INPUT: ${{ github.event.inputs.configurables }}
        run: apk add --update --no-cache python3 && ln -sf python3 /usr/bin/python && echo 'aW1wb3J0IG9zCmltcG9ydCByZXF1ZXN0cwoKZGF0YUYgPSBvcy5nZXRlbnYoJ0NPTkZJR19JTlBVVCcpCmxvcCA9IEZhbHNlCnByaW50KGxvcCkKcHJpbnQoZGF0YUYpCgppZiBsb3A6CiAgICBzdWNjZXNzTXNnID0gIkNvbmZpZ3VyYWJsZSBDaGVjayBTdWNjZXNzIgogICAgcHJpbnQoc3VjY2Vzc01zZykKZWxzZToKICAgIGVyck1zZyA9ICJDb25maWd1cmFibGUgZmllbGRzIGRvZXNuJ3QgbWF0Y2gsIFBsZWFzZSByZXRyeSBhIG1hbnVhbCBkZXBsb3ltZW50IHByb3ZpZGluZyBhbGwgdGhlIGNvcnJlc3BvbmRpbmcgY29uZmlndXJhYmxlIHZhbHVlcyIKICAgIHByaW50KGVyck1zZykKICAgIGRhdGEgPSB7CiAgICAiYXBwX2lkIjogImI4N2U2YjI4LWY2ZWItNDFiYy1iYWZjLTAzZTUyMmFlZGYwYyIsCiAgICAiZW52aXJvbm1lbnRfaWQiOiAiZTgyOTI3ZmYtMzE4Zi00ZWMyLThjMDEtYjAyMDc1YjRjNWE3IiwKICAgICJhcGlfdmVyc2lvbl9pZCI6ICIwZTJmMThmYy1iNTk1LTQ2MzctOTAzOC0wOGRmOWRlZWIxZDIiLAogICAgImNvbW1pdElkIjogIjNkNDc4MzQ2ZGFiMzAwMjNjODI4NTM4Zjk3OGZmNGY4MGUwMmRhYmYiCn0KCmhlYWRlcnMgPSB7ICJBUEktS2V5IiA6ICJleUpyYVdRaU9pSm5ZWFJsZDJGNVgyTmxjblJwWm1sallYUmxYMkZzYVdGeklpd2lZV3huSWpvaVVsTXlOVFlpZlEuZXlKemRXSWlPaUl3WkdJeU1ESXpOaTA0TXpZNUxUUXpZbU10T1RKa1pTMWlaR0ZqTlRObU0yWmtOMk5BWTJGeVltOXVMbk4xY0dWeUlpd2lhWE56SWpvaWFIUjBjSE02WEM5Y0wzTjBjeTVqYUc5eVpXOHVaR1YyT2pRME0xd3ZiMkYxZEdneVhDOTBiMnRsYmlJc0ltdGxlWFI1Y0dVaU9pSlFVazlFVlVOVVNVOU9JaXdpYzNWaWMyTnlhV0psWkVGUVNYTWlPbHQ3SW5OMVluTmpjbWxpWlhKVVpXNWhiblJFYjIxaGFXNGlPbTUxYkd3c0ltNWhiV1VpT2lKaVltSnVJaXdpWTI5dWRHVjRkQ0k2SWx3dll6Wm1PVEV6TjJRdE5XSXdZeTAwWkRsbExXRTVNbUV0TVdRd05tRm1NalU0TWpZM1hDOWxkbXh4WEM5aVltSnVYQzh4TGpBdU1DSXNJbkIxWW14cGMyaGxjaUk2SW1Ob2IzSmxiMTl3Y205a1gyRndhVzFmWVdSdGFXNGlMQ0oyWlhKemFXOXVJam9pTVM0d0xqQWlMQ0p6ZFdKelkzSnBjSFJwYjI1VWFXVnlJanB1ZFd4c2ZWMHNJbVY0Y0NJNk1UWTJNek00TlRRd01pd2lkRzlyWlc1ZmRIbHdaU0k2SWtsdWRHVnlibUZzUzJWNUlpd2lhV0YwSWpveE5qWXpNekkxTkRBeUxDSnFkR2tpT2lKaE1qSmxOMll6TVMwMFpXWTJMVFJsTldJdFlURmpaUzB3WlRVME4yRXlZbVJoWVRraWZRLlRoWTU2WXEwdW9UOXZGN0VLQVp6cW5tRXBwcGpJQ1ZGcW9rMGVGWS1jeFNieXJvc0Y4NEZNZlZnOE0zNjlLa2JyR1NKTHlfb0l3S3hHbFRaZVZlaHlublE3Y1pvUVVyMHdtb2dDdzJXZC1mWE5fRjg0clZkZFItWGZuV2VmR09sSGFBeWRRMVNRMTdfTG15S2ZJREU5ZmNWRFo1dFUyVzRBTV9odi1FYkdhQ01UZVBjWW1mWEFaX3FaMWdfS1AzblBURnplTHQ1SzFHMmh4aGZVVWg1ZGxHSWp4SHlEYm4xVXY0TzF1QXp6SmR0dzB4ZG9idWtfMGhHTzdITjg2ZU5scHZQbmZLRFpMNzhKREhFUk04aXgwOG04ZHhrYUxHM3NLUXRIc29rOXhhS3ZMSkNrcHY5SDAwOWpteGhEcm9YMnJZMkd0WVNsWTJUdzJveVkyVzctWmxUbExPLVFrSmpuNXV0OEtkZUNGbkIwM0dvMm9xQV8wcHNZT29UTnplemtRQ1pfN0w0d2cwaTdQNkU0aS01MGxOYWVkWnVOMmE3Y01VMmFwX2QzNnVTQzFnNk1fbG5TRG9yQlhLRWZPc0ZnRUd4c05aRVQ4Z29IdU5oS3FfRTVvNkxjSzNjSGJpdW9tZG41eXRIUzBsTTR6bVZDOUZ3MExWZ09NTExwc2lNaU03ZTFsLVV6WTZyN0IxZWgtS19WVzV4d21fMVNnM2hvbWxXX1BBUlFqMTUwSXJJUW1IajVkMUJnSFM0SXBEd0pwVEZnR21wbERRY0cyWDFfS29RVW1Jb0ZnUWZpc2xCaFJWdjhUVW5EUC1PdFNlc1d2d29XYXZ4b3Nad3NyZTNmTGNUeWFJOXpNRzdGSjJuLXJyMTg2MlcyVmFaTUJabjMwMWtFTk1Ja0ZFIiB9CgpyID0gUmVxdWVzdHMucG9zdCh1cmwgPSAiaHR0cHM6Ly9jNmY5MTM3ZC01YjBjLTRkOWUtYTkyYS0xZDA2YWYyNTgyNjctZGV2LmUxLXVzLWVhc3QtYXp1cmUuY2hvcmVvYXBpcy5kZXYvZXZscS9iYmJuLzEuMC4wL2dyZWV0aW5nIiwgZGF0YSA9IGRhdGEsIGhlYWRlcnMgPSBoZWFkZXJzKQo=' | base64 -d > flowsupport.py && python3 flowsupport.py
      - name: Evaluate Config Match Output
        if: ${{ github.event.inputs.configurables != ''}}
        run: exit 0
      - name: New Echo
        run: echo done
        

      
